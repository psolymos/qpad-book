<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 The Detection Process | Point count data analysis: How to violate assumptions and get away with it</title>
  <meta name="description" content="This book provides material for the workshop ‘Analysis of point-count data in the presence of variable survey methodologies and detection error’ at the AOS 2019 conference." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 The Detection Process | Point count data analysis: How to violate assumptions and get away with it" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://peter.solymos.org/qpad-book/" />
  <meta property="og:image" content="http://peter.solymos.org/qpad-book/images/cover.png" />
  <meta property="og:description" content="This book provides material for the workshop ‘Analysis of point-count data in the presence of variable survey methodologies and detection error’ at the AOS 2019 conference." />
  <meta name="github-repo" content="psolymos/qpad-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The Detection Process | Point count data analysis: How to violate assumptions and get away with it" />
  
  <meta name="twitter:description" content="This book provides material for the workshop ‘Analysis of point-count data in the presence of variable survey methodologies and detection error’ at the AOS 2019 conference." />
  <meta name="twitter:image" content="http://peter.solymos.org/qpad-book/images/cover.png" />

<meta name="author" content="Peter Solymos" />


<meta name="date" content="2019-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="behavior.html">
<link rel="next" href="recordings.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">QPAD Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-book-and-the-course"><i class="fa fa-check"></i>About the book and the course</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installing-r-and-rstudio"><i class="fa fa-check"></i>Installing R and RStudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installing-required-packages"><i class="fa fa-check"></i>Installing required packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installing-the-book"><i class="fa fa-check"></i>Installing the book</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-works"><i class="fa fa-check"></i>How this works</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#design-based-approaches"><i class="fa fa-check"></i><b>1.1</b> Design-based approaches</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#model-based-approaches"><i class="fa fa-check"></i><b>1.2</b> Model-based approaches</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#our-approach"><i class="fa fa-check"></i><b>1.3</b> Our approach</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pcdata.html"><a href="pcdata.html"><i class="fa fa-check"></i><b>2</b> Organizing and Processing Point Count Data</a><ul>
<li class="chapter" data-level="2.1" data-path="pcdata.html"><a href="pcdata.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="pcdata.html"><a href="pcdata.html#prerequisites"><i class="fa fa-check"></i><b>2.2</b> Prerequisites</a></li>
<li class="chapter" data-level="2.3" data-path="pcdata.html"><a href="pcdata.html#rbasics"><i class="fa fa-check"></i><b>2.3</b> R basics</a></li>
<li class="chapter" data-level="2.4" data-path="pcdata.html"><a href="pcdata.html#josm-data-set"><i class="fa fa-check"></i><b>2.4</b> JOSM data set</a></li>
<li class="chapter" data-level="2.5" data-path="pcdata.html"><a href="pcdata.html#cross-tabulating-species-counts"><i class="fa fa-check"></i><b>2.5</b> Cross tabulating species counts</a></li>
<li class="chapter" data-level="2.6" data-path="pcdata.html"><a href="pcdata.html#joining-species-data-with-predictors"><i class="fa fa-check"></i><b>2.6</b> Joining species data with predictors</a></li>
<li class="chapter" data-level="2.7" data-path="pcdata.html"><a href="pcdata.html#explore-predictor-variables"><i class="fa fa-check"></i><b>2.7</b> Explore predictor variables</a></li>
<li class="chapter" data-level="2.8" data-path="pcdata.html"><a href="pcdata.html#derived-variables"><i class="fa fa-check"></i><b>2.8</b> Derived variables</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>3</b> A Primer in Regression Techniques</a><ul>
<li class="chapter" data-level="3.1" data-path="regression.html"><a href="regression.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="regression.html"><a href="regression.html#prerequisites-1"><i class="fa fa-check"></i><b>3.2</b> Prerequisites</a></li>
<li class="chapter" data-level="3.3" data-path="regression.html"><a href="regression.html#poisson-null-model"><i class="fa fa-check"></i><b>3.3</b> Poisson null model</a></li>
<li class="chapter" data-level="3.4" data-path="regression.html"><a href="regression.html#exploring-covariates"><i class="fa fa-check"></i><b>3.4</b> Exploring covariates</a></li>
<li class="chapter" data-level="3.5" data-path="regression.html"><a href="regression.html#single-covariate"><i class="fa fa-check"></i><b>3.5</b> Single covariate</a></li>
<li class="chapter" data-level="3.6" data-path="regression.html"><a href="regression.html#additive-model"><i class="fa fa-check"></i><b>3.6</b> Additive model</a></li>
<li class="chapter" data-level="3.7" data-path="regression.html"><a href="regression.html#nonlinear-terms"><i class="fa fa-check"></i><b>3.7</b> Nonlinear terms</a></li>
<li class="chapter" data-level="3.8" data-path="regression.html"><a href="regression.html#categorical-variables"><i class="fa fa-check"></i><b>3.8</b> Categorical variables</a></li>
<li class="chapter" data-level="3.9" data-path="regression.html"><a href="regression.html#multiple-main-effects"><i class="fa fa-check"></i><b>3.9</b> Multiple main effects</a></li>
<li class="chapter" data-level="3.10" data-path="regression.html"><a href="regression.html#interaction"><i class="fa fa-check"></i><b>3.10</b> Interaction</a></li>
<li class="chapter" data-level="3.11" data-path="regression.html"><a href="regression.html#different-error-distributions"><i class="fa fa-check"></i><b>3.11</b> Different error distributions</a></li>
<li class="chapter" data-level="3.12" data-path="regression.html"><a href="regression.html#count-duration-effects"><i class="fa fa-check"></i><b>3.12</b> Count duration effects</a></li>
<li class="chapter" data-level="3.13" data-path="regression.html"><a href="regression.html#count-radius-effects"><i class="fa fa-check"></i><b>3.13</b> Count radius effects</a></li>
<li class="chapter" data-level="3.14" data-path="regression.html"><a href="regression.html#offsets"><i class="fa fa-check"></i><b>3.14</b> Offsets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="behavior.html"><a href="behavior.html"><i class="fa fa-check"></i><b>4</b> Behavioral Complexities</a><ul>
<li class="chapter" data-level="4.1" data-path="behavior.html"><a href="behavior.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="behavior.html"><a href="behavior.html#prerequisites-2"><i class="fa fa-check"></i><b>4.2</b> Prerequisites</a></li>
<li class="chapter" data-level="4.3" data-path="behavior.html"><a href="behavior.html#birds-in-the-forest"><i class="fa fa-check"></i><b>4.3</b> Birds in the forest</a></li>
<li class="chapter" data-level="4.4" data-path="behavior.html"><a href="behavior.html#survival-model"><i class="fa fa-check"></i><b>4.4</b> Survival model</a></li>
<li class="chapter" data-level="4.5" data-path="behavior.html"><a href="behavior.html#vocalization-events"><i class="fa fa-check"></i><b>4.5</b> Vocalization events</a></li>
<li class="chapter" data-level="4.6" data-path="behavior.html"><a href="behavior.html#removal-model"><i class="fa fa-check"></i><b>4.6</b> Removal model</a><ul>
<li class="chapter" data-level="4.6.1" data-path="behavior.html"><a href="behavior.html#real-data"><i class="fa fa-check"></i><b>4.6.1</b> Real data</a></li>
<li class="chapter" data-level="4.6.2" data-path="behavior.html"><a href="behavior.html#time-invariant-conventional-model"><i class="fa fa-check"></i><b>4.6.2</b> Time-invariant conventional model</a></li>
<li class="chapter" data-level="4.6.3" data-path="behavior.html"><a href="behavior.html#time-varying-conventional-removal-model"><i class="fa fa-check"></i><b>4.6.3</b> Time-varying conventional removal model</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="behavior.html"><a href="behavior.html#finite-mixtures"><i class="fa fa-check"></i><b>4.7</b> Finite mixtures</a><ul>
<li class="chapter" data-level="4.7.1" data-path="behavior.html"><a href="behavior.html#time-invariant-finite-mixture-removal-model"><i class="fa fa-check"></i><b>4.7.1</b> Time-invariant finite mixture removal model</a></li>
<li class="chapter" data-level="4.7.2" data-path="behavior.html"><a href="behavior.html#time-varying-finite-mixture-removal-models"><i class="fa fa-check"></i><b>4.7.2</b> Time-varying finite mixture removal models</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="behavior.html"><a href="behavior.html#let-the-best-model-win"><i class="fa fa-check"></i><b>4.8</b> Let the best model win</a></li>
<li class="chapter" data-level="4.9" data-path="behavior.html"><a href="behavior.html#estimating-abundance"><i class="fa fa-check"></i><b>4.9</b> Estimating abundance</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="detection.html"><a href="detection.html"><i class="fa fa-check"></i><b>5</b> The Detection Process</a><ul>
<li class="chapter" data-level="5.1" data-path="detection.html"><a href="detection.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="detection.html"><a href="detection.html#prerequisites-3"><i class="fa fa-check"></i><b>5.2</b> Prerequisites</a></li>
<li class="chapter" data-level="5.3" data-path="detection.html"><a href="detection.html#distance-functions"><i class="fa fa-check"></i><b>5.3</b> Distance functions</a></li>
<li class="chapter" data-level="5.4" data-path="detection.html"><a href="detection.html#distance-sampling"><i class="fa fa-check"></i><b>5.4</b> Distance sampling</a></li>
<li class="chapter" data-level="5.5" data-path="detection.html"><a href="detection.html#average-detection"><i class="fa fa-check"></i><b>5.5</b> Average detection</a></li>
<li class="chapter" data-level="5.6" data-path="detection.html"><a href="detection.html#binned-distances"><i class="fa fa-check"></i><b>5.6</b> Binned distances</a></li>
<li class="chapter" data-level="5.7" data-path="detection.html"><a href="detection.html#end-of-section"><i class="fa fa-check"></i><b>5.7</b> End of section</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="recordings.html"><a href="recordings.html"><i class="fa fa-check"></i><b>6</b> Dealing with Recordings</a></li>
<li class="chapter" data-level="7" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>7</b> A Closer Look at Assumptions</a></li>
<li class="chapter" data-level="8" data-path="roadsides.html"><a href="roadsides.html"><i class="fa fa-check"></i><b>8</b> Understanding Roadside Surveys</a></li>
<li class="chapter" data-level="9" data-path="extras.html"><a href="extras.html"><i class="fa fa-check"></i><b>9</b> Miscellaneous Topics</a><ul>
<li class="chapter" data-level="" data-path="extras.html"><a href="extras.html#these-are-just-reminders-to-be-deleted-later"><i class="fa fa-check"></i>These are just reminders, to be deleted later</a></li>
<li class="chapter" data-level="9.1" data-path="extras.html"><a href="extras.html#binomial-model-and-censoring"><i class="fa fa-check"></i><b>9.1</b> Binomial model and censoring</a></li>
<li class="chapter" data-level="9.2" data-path="extras.html"><a href="extras.html#optimal-partitioning"><i class="fa fa-check"></i><b>9.2</b> Optimal partitioning</a></li>
<li class="chapter" data-level="9.3" data-path="extras.html"><a href="extras.html#optilevels"><i class="fa fa-check"></i><b>9.3</b> Optilevels</a></li>
<li class="chapter" data-level="9.4" data-path="extras.html"><a href="extras.html#n-mixture-models"><i class="fa fa-check"></i><b>9.4</b> N-mixture models</a></li>
<li class="chapter" data-level="9.5" data-path="extras.html"><a href="extras.html#estimating-abundance-1"><i class="fa fa-check"></i><b>9.5</b> Estimating abundance</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://peter.solymos.org/" target="blank">P&eacute;ter S&oacute;lymos</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Point count data analysis: How to violate assumptions and get away with it</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="detection" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> The Detection Process</h1>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>As part of the detection process, a skilled observer
counts individual birds at a count station.
New individuals are assigned to time and distance categories,
the type of behavior also registered.
During this process, auditory cues travel through
the distance between the bird and the observer.
As the pover of the sound fades away, the
chanches of being detected also decreases.
If the detection process is based on visual detections,
vegetation can block line of sight, etc.
In this chapter, we scrutinize how this detection process
contributes to the factor <span class="math inline">\(C\)</span>.</p>
</div>
<div id="prerequisites-3" class="section level2">
<h2><span class="header-section-number">5.2</span> Prerequisites</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bSims)                <span class="co"># simulations</span>
<span class="kw">library</span>(detect)               <span class="co"># multinomial models</span>
<span class="kw">library</span>(Distance)             <span class="co"># distance sampling</span>
<span class="kw">load</span>(<span class="st">&quot;_data/josm/josm.rda&quot;</span>)   <span class="co"># JOSM data</span>
<span class="kw">source</span>(<span class="st">&quot;functions.R&quot;</span>)         <span class="co"># some useful stuff</span></code></pre>
</div>
<div id="distance-functions" class="section level2">
<h2><span class="header-section-number">5.3</span> Distance functions</h2>
<p>The distance function (<span class="math inline">\(g(r)\)</span> describes the probability of detecting an individual
given the distance between the observer and the individual (<span class="math inline">\(r\)</span>).
The detection itself is often triggered by visual or auditory cues,
and thus depend on the individuals being available for detection
(and of course being present in the survey area).</p>
<p>Distance functions have some characteristics:</p>
<ul>
<li>It is a monotonic decreasing function of distance,</li>
<li><span class="math inline">\(g(0)=1\)</span>: detection at 0 distance is perfect.</li>
</ul>
<p>Here are some common distance function and rationale for their use
(i.e. mechanisms leading to such distance shapes):</p>
<ol style="list-style-type: decimal">
<li>Negative Exponential: a one-parameter function (<span class="math inline">\(g(r) = e^{-r/\tau}\)</span>), probability quickly decreases with distance, this mirrors sound attenuation under spherical spreading, so might be a suitable form for acoustic recoding devices (we will revisit this later), but not a very useful form for human based counts, as explained below;</li>
<li>Half-Normal: this is also a one-parameter function (<span class="math inline">\(g(r) = e^{-(r/\tau)^2}\)</span>) where probability initially remain high (the <em>shoulder</em>), reflecting an increased chance of detecting individuals closer to the observer, this form has also sone practical advantages that we will discuss shortly (<span class="math inline">\(\tau^2\)</span> is variance of the unfolded Normal distribution, <span class="math inline">\(\tau^2/2\)</span> is the variance of the Half-Normal distribution – both the Negative Exponential and the Half-Normal being special cases of <span class="math inline">\(g(r) = e^{-(r/\tau)^b}\)</span> that have the parameter <span class="math inline">\(b\)</span> [<span class="math inline">\(b &gt; 0\)</span>] affecting the shoulder);</li>
<li>Hazard rate: this is a two-parameter model (<span class="math inline">\(g(r) = 1-e^{-(r/\tau)^-b}\)</span>) that have the parameter <span class="math inline">\(b\)</span> (<span class="math inline">\(b &gt; 0\)</span>) affecting the more pronounced and sharp shoulder.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">r &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)
<span class="kw">plot</span>(r, <span class="kw">exp</span>(<span class="op">-</span>r<span class="op">/</span><span class="fl">0.8</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
  <span class="dt">xlab=</span><span class="st">&quot;Distance (100 m)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;P(detection)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Negative Exponential&quot;</span>)
<span class="kw">plot</span>(r, <span class="kw">exp</span>(<span class="op">-</span>(r<span class="op">/</span><span class="fl">0.8</span>)<span class="op">^</span><span class="dv">2</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
  <span class="dt">xlab=</span><span class="st">&quot;Distance (100 m)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;P(detection)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Half-Normal&quot;</span>)
<span class="kw">plot</span>(r, <span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(r<span class="op">/</span><span class="fl">0.8</span>)<span class="op">^-</span><span class="dv">4</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
  <span class="dt">xlab=</span><span class="st">&quot;Distance (100 m)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;P(detection)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Hazard rate&quot;</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-306-1.png" width="33%" /><img src="qpad-book_files/figure-html/unnamed-chunk-306-2.png" width="33%" /><img src="qpad-book_files/figure-html/unnamed-chunk-306-3.png" width="33%" /></p>

<div class="rmdexercise">
<p><strong>Exercise</strong></p>
<p>Try different values of <span class="math inline">\(b\)</span> to explore the different shapes of the Hazard rate function.</p>
Write your own code (<code>plot(r, exp(-(r/&lt;tau&gt;)^&lt;b&gt;), type=&quot;l&quot;, ylim=c(0,1))</code>), or run <code>shiny::runApp(&quot;_shiny/distancefun.R&quot;)</code>.
</div>

<p>We will apply this new found knowledge to our bSims world:
the observer is in the middle of the landscape, and each vocalization
event is aither detected or not, depending on the distance.
Units of <code>tau</code> are given on 100 m units, so that corresponding
density estimates will refer to ha as the unit area.</p>
<p>In this example, we want all individuals to be equally available,
so we are going to override all behavioral aspects of the simulations
by the <code>initial_location</code> argument when calling <code>bsims_animate</code>.
We set <code>density</code> and <code>tau</code> high enough to detections in this example.</p>
<pre class="sourceCode r"><code class="sourceCode r">tau &lt;-<span class="st"> </span><span class="dv">2</span>

<span class="kw">set.seed</span>(<span class="dv">123</span>)
l &lt;-<span class="st"> </span><span class="kw">bsims_init</span>()
a &lt;-<span class="st"> </span><span class="kw">bsims_populate</span>(l, <span class="dt">density=</span><span class="dv">10</span>)
b &lt;-<span class="st"> </span><span class="kw">bsims_animate</span>(a, <span class="dt">initial_location=</span><span class="ot">TRUE</span>)

(d &lt;-<span class="st"> </span><span class="kw">bsims_detect</span>(b, <span class="dt">tau=</span>tau, <span class="dt">vocal_only=</span><span class="ot">FALSE</span>))</code></pre>
<pre><code>## bSims detections
##   1 km x 1 km
##   stratification: H
##   total abundance: 1013
##   total duration: 10
##   detected: 128 seen/heard</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(d)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-309-1.png" width="768" /></p>
</div>
<div id="distance-sampling" class="section level2">
<h2><span class="header-section-number">5.4</span> Distance sampling</h2>
<p>The distribution of the <em>observed distances</em> is a product of detectability
and the distribution of the individuals with respect to the point where
the observer is located.
For point counts, area increases linearly with radial distance,
implying a triangular distribution with respect to the point
(<span class="math inline">\(h(r)=\pi 2 r /A=\pi 2 r / \pi r_{max}^2=2 r / r_{max}^2\)</span>, where
<span class="math inline">\(A\)</span> is a circular survey area with truncation distance <span class="math inline">\(r_{max}\)</span>).
The product <span class="math inline">\(g(r) h(r)\)</span> gives the density function of the observed distances.</p>
<pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="cf">function</span>(r, tau, <span class="dt">b=</span><span class="dv">2</span>, <span class="dt">hazard=</span><span class="ot">FALSE</span>)
  <span class="cf">if</span> (hazard)
    <span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(r<span class="op">/</span>tau)<span class="op">^-</span>b) <span class="cf">else</span> <span class="kw">exp</span>(<span class="op">-</span>(r<span class="op">/</span>tau)<span class="op">^</span>b)
h &lt;-<span class="st"> </span><span class="cf">function</span>(r, rmax)
  <span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>rmax<span class="op">^</span><span class="dv">2</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rmax &lt;-<span class="st"> </span><span class="dv">4</span>

r &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, rmax, <span class="fl">0.01</span>)
<span class="kw">plot</span>(r, <span class="kw">g</span>(r, tau), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
  <span class="dt">xlab=</span><span class="st">&quot;r&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;g(r)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Prob. of detection&quot;</span>)
<span class="kw">plot</span>(r, <span class="kw">h</span>(r, rmax), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>,
  <span class="dt">xlab=</span><span class="st">&quot;r&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;h(r)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;PDF of distances&quot;</span>)
<span class="kw">plot</span>(r, <span class="kw">g</span>(r, tau) <span class="op">*</span><span class="st"> </span><span class="kw">h</span>(r, rmax), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>,
  <span class="dt">xlab=</span><span class="st">&quot;r&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;g(r) h(r)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Density of observed distances&quot;</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-311-1.png" width="33%" /><img src="qpad-book_files/figure-html/unnamed-chunk-311-2.png" width="33%" /><img src="qpad-book_files/figure-html/unnamed-chunk-311-3.png" width="33%" /></p>
<p>The object <code>ra</code> contains the distances to all the nests
based on our bSims object,
we use this to display the distribution of available distances:</p>
<pre class="sourceCode r"><code class="sourceCode r">ra &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rowSums</span>(a<span class="op">$</span>nests[,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)]<span class="op">^</span><span class="dv">2</span>))

<span class="kw">hist</span>(ra[ra <span class="op">&lt;=</span><span class="st"> </span>rmax], <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, rmax),
  <span class="dt">xlab=</span><span class="st">&quot;Available distances (r &lt;= rmax)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>)
<span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">/</span>rmax<span class="op">^</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="dv">2</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-312-1.png" width="672" /></p>
<p>The <code>get_detections</code> function returns a data frame with the
detected events (in our case just the nest locations):
<code>$d</code> is the distance, <code>$a</code> is the angle
(in degrees, counter clock-wise from positive x axis).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dt &lt;-<span class="st"> </span><span class="kw">get_detections</span>(d))</code></pre>
<p>The following code plots the probability density of the
observed distances within the truncation distance <span class="math inline">\(r_{max}\)</span>,
thus we need to standardize the <span class="math inline">\(g(r) h(r)\)</span> function
by the integral sum:</p>
<pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(r, tau, <span class="dt">b=</span><span class="dv">2</span>, <span class="dt">hazard=</span><span class="ot">FALSE</span>, <span class="dt">rmax=</span><span class="dv">1</span>) 
  <span class="kw">g</span>(r, tau, b, hazard) <span class="op">*</span><span class="st"> </span><span class="kw">h</span>(r, rmax)
tot &lt;-<span class="st"> </span><span class="kw">integrate</span>(f, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span>rmax, <span class="dt">tau=</span>tau, <span class="dt">rmax=</span>rmax)<span class="op">$</span>value

<span class="kw">hist</span>(dt<span class="op">$</span>d[dt<span class="op">$</span>d <span class="op">&lt;=</span><span class="st"> </span>rmax], <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, rmax),
  <span class="dt">xlab=</span><span class="st">&quot;Observed distances (r &lt;= rmax)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>)
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dt">tau=</span>tau, <span class="dt">rmax=</span>rmax) <span class="op">/</span><span class="st"> </span>tot, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="dv">2</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-314-1.png" width="672" /></p>
<p>In case of the Half-Normal, we can linearize the relationship
by taking the log of the distance function:
<span class="math inline">\(log(g(r)) =log(e^{-(r/\tau)^2})= -(r / \tau)^2 = x \frac{1}{\tau^2} = 0 + x \beta\)</span>.
Consequently, we can use GLM to fit a model with <span class="math inline">\(x = -r^2\)</span> as
predictor and no intercept, and estimate <span class="math inline">\(\hat{\beta}\)</span> and
<span class="math inline">\(\hat{\tau}=\sqrt{1/\hat{\beta}}\)</span>.</p>
<p>For this method to work, we need to know the observed and
unobserved distances as well,
which makes this approach of low utility in practice when
location of unobserved individuals is unknown.
But we can at least check our bSims data:</p>
<pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">distance=</span>ra, 
  <span class="dt">x=</span><span class="op">-</span>ra<span class="op">^</span><span class="dv">2</span>, 
  <span class="dt">detected=</span><span class="kw">ifelse</span>(<span class="kw">rownames</span>(d<span class="op">$</span>nests) <span class="op">%in%</span><span class="st"> </span>dt<span class="op">$</span>i, <span class="dv">1</span>, <span class="dv">0</span>))
<span class="kw">summary</span>(dat)</code></pre>
<pre><code>##     distance           x             detected    
##  Min.   :0.226   Min.   :-49.33   Min.   :0.000  
##  1st Qu.:2.876   1st Qu.:-23.74   1st Qu.:0.000  
##  Median :3.965   Median :-15.72   Median :0.000  
##  Mean   :3.827   Mean   :-16.69   Mean   :0.126  
##  3rd Qu.:4.872   3rd Qu.: -8.27   3rd Qu.:0.000  
##  Max.   :7.024   Max.   : -0.05   Max.   :1.000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">mod &lt;-<span class="st"> </span><span class="kw">glm</span>(detected <span class="op">~</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span>dat, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>))
<span class="kw">c</span>(<span class="dt">true=</span>tau, <span class="dt">estimate=</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">coef</span>(mod)))</code></pre>
<pre><code>##       true estimate.x 
##      2.000      2.034</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">coef</span>(mod)))<span class="op">^</span><span class="dv">2</span>), 
  <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(dat<span class="op">$</span>distance)), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
  <span class="dt">xlab=</span><span class="st">&quot;Distance (100 m)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;P(detection)&quot;</span>)
<span class="kw">curve</span>(<span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">/</span>tau)<span class="op">^</span><span class="dv">2</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">rug</span>(dat<span class="op">$</span>distance[dat<span class="op">$</span>detected <span class="op">==</span><span class="st"> </span><span class="dv">0</span>], <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">rug</span>(dat<span class="op">$</span>distance[dat<span class="op">$</span>detected <span class="op">==</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">side=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), 
  <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;Estimated&quot;</span>))</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-316-1.png" width="672" /></p>
<p>The Distance package offers various tools to fit
models to observed distance data.
See <a href="https://workshops.distancesampling.org/duke-spatial-2015/practicals/1-detection-functions-solutions.html">here</a> for a tutorial.
The following script fits the Half-Normal (<code>key = &quot;hn&quot;</code>)
without ajustments (<code>adjustment=NULL</code>) to<br />
observed distance data from truncated point transect.
It estimates <span class="math inline">\(\sigma = \sqrt{\tau}\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">dd &lt;-<span class="st"> </span><span class="kw">ds</span>(dt<span class="op">$</span>d, <span class="dt">truncation =</span> rmax, <span class="dt">transect=</span><span class="st">&quot;point&quot;</span>, 
  <span class="dt">key =</span> <span class="st">&quot;hn&quot;</span>, <span class="dt">adjustment=</span><span class="ot">NULL</span>)</code></pre>
<pre><code>## Fitting half-normal key function</code></pre>
<pre><code>## Key only model: not constraining for monotonicity.</code></pre>
<pre><code>## AIC= 315.502</code></pre>
<pre><code>## No survey area information supplied, only estimating detection function.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dt">true=</span>tau, <span class="dt">estimate=</span><span class="kw">exp</span>(dd<span class="op">$</span>ddf<span class="op">$</span>par)<span class="op">^</span><span class="dv">2</span>)</code></pre>
<pre><code>##     true estimate 
##    2.000    2.176</code></pre>
</div>
<div id="average-detection" class="section level2">
<h2><span class="header-section-number">5.5</span> Average detection</h2>
<p>To calculate the average probability of detecting individuals
within a circle with truncation distance <span class="math inline">\(r_{max}\)</span>, we need to
integrate over the product of <span class="math inline">\(g(r)\)</span> and <span class="math inline">\(h(r)\)</span>:
<span class="math inline">\(q(r_{max})=\int_{0}^{r_{max}} g(r) h(r) dr\)</span>.
This gives the volume of pie dough cut at <span class="math inline">\(r_{max}\)</span>,
compared to the volume of the cookie cutter (<span class="math inline">\(\pi r_{max}^2\)</span>).</p>
<pre class="sourceCode r"><code class="sourceCode r">q &lt;-<span class="st"> </span><span class="kw">sapply</span>(r[r <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>], <span class="cf">function</span>(z)
  <span class="kw">integrate</span>(f, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span>z, <span class="dt">tau=</span>tau, <span class="dt">rmax=</span>z)<span class="op">$</span>value)

<span class="kw">plot</span>(r, <span class="kw">c</span>(<span class="dv">1</span>, q), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
  <span class="dt">xlab=</span><span class="kw">expression</span>(r[max]), <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">q</span>(r[max])), 
  <span class="dt">main=</span><span class="st">&quot;Average prob. of detection&quot;</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-318-1.png" width="672" /></p>
<p>For the Half-Normal detection function, the analytical solution for the
average probability is
<span class="math inline">\(\pi \tau^2 [1-exp(-r^2/\tau^2)] / (\pi r_{max}^2)\)</span>,
where the denominator is a normalizing constant
representing the volume of a cylinder of perfect detectability.</p>
<p>To visualize this, here is the pie analogy for
<span class="math inline">\(\tau=2\)</span> and <span class="math inline">\(r_{max}=2\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">tau &lt;-<span class="st"> </span><span class="dv">2</span>
rmax &lt;-<span class="st"> </span><span class="dv">2</span>
w &lt;-<span class="st"> </span><span class="fl">0.1</span>
<span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>rmax, rmax), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>w, <span class="dv">1</span><span class="op">+</span>w), <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">ann=</span><span class="ot">FALSE</span>)
yh &lt;-<span class="st"> </span><span class="kw">g</span>(rmax, <span class="dt">tau=</span>tau)
<span class="kw">lines</span>(<span class="kw">seq</span>(<span class="op">-</span>rmax, rmax, rmax<span class="op">/</span><span class="dv">100</span>),
  <span class="kw">g</span>(<span class="kw">abs</span>(<span class="kw">seq</span>(<span class="op">-</span>rmax, rmax, rmax<span class="op">/</span><span class="dv">100</span>)), <span class="dt">tau=</span>tau))
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, yh, rmax, w, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="op">-</span><span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(<span class="dv">0</span>, yh))
<span class="kw">lines</span>(<span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(<span class="dv">0</span>, yh))
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, <span class="dv">0</span>, rmax, w)
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, <span class="dv">1</span>, rmax, w, <span class="dt">border=</span><span class="st">&quot;grey&quot;</span>)
<span class="kw">lines</span>(<span class="op">-</span><span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(yh, <span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(yh, <span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
</div>
<div id="binned-distances" class="section level2">
<h2><span class="header-section-number">5.6</span> Binned distances</h2>
<p>The cumulative density function for the Half-Normal
distribution (<span class="math inline">\(\pi(r) = 1-e^{-(r/\tau)^2}\)</span>) is used to calculate
cell probabilities for binned distance data
(the normalizing constant is the area of the integral <span class="math inline">\(\pi \tau^2\)</span>,
instead of <span class="math inline">\(\pi r_{max}^2\)</span>).
It captures the proportion of the observed distances
relative to the whole volume of the observed distance density.
In the pie analogy, this is the dough volume inside
the cookie cutter, compared to the dough volume inside and outside
of the cutter (that happens to be <span class="math inline">\(\pi \tau^2\)</span> for the Half-Normal):</p>
<pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span>m<span class="op">*</span><span class="kw">c</span>(<span class="op">-</span>rmax, rmax), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>w, <span class="dv">1</span><span class="op">+</span>w), 
  <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">ann=</span><span class="ot">FALSE</span>)
yh &lt;-<span class="st"> </span><span class="kw">g</span>(rmax, <span class="dt">tau=</span>tau)
<span class="kw">lines</span>(<span class="kw">seq</span>(<span class="op">-</span>m<span class="op">*</span>rmax, m<span class="op">*</span>rmax, rmax<span class="op">/</span>(m<span class="op">*</span><span class="dv">100</span>)),
  <span class="kw">g</span>(<span class="kw">seq</span>(<span class="op">-</span>m<span class="op">*</span>rmax, m<span class="op">*</span>rmax, rmax<span class="op">/</span>(m<span class="op">*</span><span class="dv">100</span>)), <span class="dt">tau=</span>tau),
  <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)
<span class="kw">lines</span>(<span class="kw">seq</span>(<span class="op">-</span>rmax, rmax, rmax<span class="op">/</span><span class="dv">100</span>),
  <span class="kw">g</span>(<span class="kw">abs</span>(<span class="kw">seq</span>(<span class="op">-</span>rmax, rmax, rmax<span class="op">/</span><span class="dv">100</span>)), <span class="dt">tau=</span>tau))
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, yh, rmax, w, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="op">-</span><span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(<span class="dv">0</span>, yh))
<span class="kw">lines</span>(<span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(<span class="dv">0</span>, yh))
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, <span class="dv">0</span>, rmax, w)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-320-1.png" width="672" /></p>
<p>In case of the Half-Normal distance function,
<span class="math inline">\(\tau\)</span> is the <em>effective detection radius</em> (EDR).
The effective detection radius is the distance from observer
where the number of individuals missed within EDR
(volume of ‘air’ in the cookie cutter above the dough)
equals the number of individuals detected outside of EDR
(dough volume outside the cookie cutter),
EDR is the radius <span class="math inline">\(r_e\)</span> where <span class="math inline">\(q(r_e)=\pi(r_e)\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span>m<span class="op">*</span><span class="kw">c</span>(<span class="op">-</span>rmax, rmax), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>w, <span class="dv">1</span><span class="op">+</span>w), 
  <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">ann=</span><span class="ot">FALSE</span>)
yh &lt;-<span class="st"> </span><span class="kw">g</span>(rmax, <span class="dt">tau=</span>tau)
<span class="kw">lines</span>(<span class="kw">seq</span>(<span class="op">-</span>m<span class="op">*</span>rmax, m<span class="op">*</span>rmax, rmax<span class="op">/</span>(m<span class="op">*</span><span class="dv">100</span>)),
  <span class="kw">g</span>(<span class="kw">seq</span>(<span class="op">-</span>m<span class="op">*</span>rmax, m<span class="op">*</span>rmax, rmax<span class="op">/</span>(m<span class="op">*</span><span class="dv">100</span>)), <span class="dt">tau=</span>tau),
  <span class="dt">col=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="kw">seq</span>(<span class="op">-</span>rmax, rmax, rmax<span class="op">/</span><span class="dv">100</span>),
  <span class="kw">g</span>(<span class="kw">abs</span>(<span class="kw">seq</span>(<span class="op">-</span>rmax, rmax, rmax<span class="op">/</span><span class="dv">100</span>)), <span class="dt">tau=</span>tau))
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, yh, rmax, w, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="op">-</span><span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(<span class="dv">0</span>, yh))
<span class="kw">lines</span>(<span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(<span class="dv">0</span>, yh))
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, <span class="dv">0</span>, rmax, w)
<span class="kw">draw_ellipse</span>(<span class="dv">0</span>, <span class="dv">1</span>, rmax, w, <span class="dt">border=</span><span class="dv">4</span>)
<span class="kw">lines</span>(<span class="op">-</span><span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(yh, <span class="dv">1</span>), <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">lines</span>(<span class="kw">c</span>(rmax, rmax), <span class="kw">c</span>(yh, <span class="dv">1</span>), <span class="dt">col=</span><span class="dv">4</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
<p>The function <span class="math inline">\(\pi(r)\)</span> increases monotonically from 0 to 1:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">/</span>tau)<span class="op">^</span><span class="dv">2</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">col=</span><span class="dv">4</span>,
  <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">pi</span>(r)), <span class="dt">xlab=</span><span class="kw">expression</span>(r), 
  <span class="dt">main=</span><span class="st">&quot;Cumulative density&quot;</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-322-1.png" width="672" /></p>
<p>Here are binned distances for the bSims data, with expected
proportions based on <span class="math inline">\(\pi()\)</span> cell probabilities
(differences within the distance bins).
The nice thing about this cumulative density formulation
is that it applies equally to truncated and unlimited
(not truncated) distance data, and the radius end point
for a bin (stored in <code>br</code>) can be infinite:</p>
<pre class="sourceCode r"><code class="sourceCode r">br &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="ot">Inf</span>)
dat<span class="op">$</span>bin &lt;-<span class="st"> </span><span class="kw">cut</span>(ra, <span class="kw">c</span>(<span class="dv">0</span>, br), <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)
(counts &lt;-<span class="st"> </span><span class="kw">with</span>(dat, <span class="kw">table</span>(bin, detected)))</code></pre>
<pre><code>##          detected
## bin         0   1
##   [0,1]     7  27
##   (1,2]    42  53
##   (2,3]   111  32
##   (3,4]   227  13
##   (4,5]   287   2
##   (5,Inf] 211   1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">pi_br &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(br<span class="op">/</span>tau)<span class="op">^</span><span class="dv">2</span>)

<span class="kw">barplot</span>(counts[,<span class="st">&quot;1&quot;</span>]<span class="op">/</span><span class="kw">sum</span>(counts[,<span class="st">&quot;1&quot;</span>]), <span class="dt">space=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="ot">NA</span>,
  <span class="dt">xlab=</span><span class="st">&quot;Distance bins (100 m)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Proportions&quot;</span>)
<span class="kw">lines</span>(<span class="kw">seq_len</span>(<span class="kw">length</span>(br))<span class="op">-</span><span class="fl">0.5</span>, <span class="kw">diff</span>(<span class="kw">c</span>(<span class="dv">0</span>, pi_br)), <span class="dt">col=</span><span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
<p>We can use the <code>bsims_transcribe</code> function for the same effect,
and estimate <span class="math inline">\(\hat{\tau}\)</span> based on the binned data:</p>
<pre class="sourceCode r"><code class="sourceCode r">(tr &lt;-<span class="st"> </span><span class="kw">bsims_transcribe</span>(d, <span class="dt">rint=</span>br))</code></pre>
<pre><code>## bSims transcript
##   1 km x 1 km
##   stratification: H
##   total abundance: 1013
##   total duration: 10
##   detected: 128 seen/heard
##   1st inds. [0-10 min] [0-100, 100-200, 200-300, 300-400, 400-500, 500+ m]</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">tr<span class="op">$</span>removal</code></pre>
<pre><code>##          0-10min
## 0-100m        27
## 100-200m      53
## 200-300m      32
## 300-400m      13
## 400-500m       2
## 500+m          1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">drop</span>(tr<span class="op">$</span>removal), <span class="dt">nrow=</span><span class="dv">1</span>)
D &lt;-<span class="st"> </span><span class="kw">matrix</span>(br, <span class="dt">nrow=</span><span class="dv">1</span>)

tauhat &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">cmulti.fit</span>(Y, D, <span class="dt">type=</span><span class="st">&quot;dis&quot;</span>)<span class="op">$</span>coef)

<span class="kw">c</span>(<span class="dt">true=</span>tau, <span class="dt">estimate=</span>tauhat)</code></pre>
<pre><code>##     true estimate 
##    2.000    2.067</code></pre>
<p>Here are cumulative counts and the true end expected
cumulative cell probabilities:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">stepfun</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">cumsum</span>(counts[,<span class="st">&quot;1&quot;</span>])<span class="op">/</span><span class="kw">sum</span>(counts[,<span class="st">&quot;1&quot;</span>]))), 
  <span class="dt">do.points=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">&quot;Binned CDF&quot;</span>,
  <span class="dt">ylab=</span><span class="st">&quot;Cumulative probability&quot;</span>, 
  <span class="dt">xlab=</span><span class="st">&quot;Bin radius end point (100 m)&quot;</span>)
<span class="kw">curve</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">/</span>tau)<span class="op">^</span><span class="dv">2</span>), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">curve</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">/</span>tauhat)<span class="op">^</span><span class="dv">2</span>), <span class="dt">col=</span><span class="dv">4</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>), 
  <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;Estimated&quot;</span>, <span class="st">&quot;Empirical&quot;</span>))</code></pre>
<p><img src="qpad-book_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
<p>EDR, tau constant</p>
<p>truncated, unlimited</p>
<p>JOSM data</p>
<p>variable tau: habitat effect (continuous case?)</p>
<p>discrete: land cover, observer effects</p>
<p>contrast fixed effects with offsets – motivation for ARU</p>
</div>
<div id="end-of-section" class="section level2">
<h2><span class="header-section-number">5.7</span> End of section</h2>
<p>Sometimes, a recording is made at the survey location
that is listened to and transcribed in the lab
using headphones and possibly a computer screen.
This presents new challenges, and also new opportunities
for analysis of count data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="behavior.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="recordings.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psolymos/qpad-book/edit/master/05-detection.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["qpad-book.pdf", "qpad-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
